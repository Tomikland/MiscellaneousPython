'''
Usage:
  getpics.py <YEAR>

Options:
    <YEAR> Download this year
'''

import cv2
from docopt import docopt

arguments = docopt(__doc__)
print arguments

def compile_data():
    data = dict()

    data[1996] = dict()
    data[1996]["video"] = "./clips/1996HINTS.mp4"
    data[1996]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[1996]["starting case"] = 1

    data[1997] = dict()
    data[1997]["video"] = "./clips/1997HINTS.mp4"
    data[1997]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[1997]["starting case"] = 44

    data[1998] = dict()
    data[1998]["video"] = "./clips/1998HINTS.mp4"
    data[1998]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[1998]["starting case"] = 87

    data[1999] = dict()
    data[1999]["video"] = "./clips/1999HINTS.mp4"
    data[1999]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[1999]["starting case"] = 130 

    data[2000] = dict()
    data[2000]["video"] = "./clips/2000HINTS.mp4"
    data[2000]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[2000]["starting case"] = 175

    data[2001] = dict()
    data[2001]["video"] = "./clips/2001HINTS.mp4"
    data[2001]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[2001]["starting case"] = 220

    data[2002] = dict()
    data[2002]["video"] = "./clips/2002HINTS.mp4"
    data[2002]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[2002]["starting case"] = 264

    data[2003] = dict()
    data[2003]["video"] = "./clips/2003HINTS.mp4"
    data[2003]["times"] = [0, 11000, 21000, 31000, 41000, 51000, 61000, 71000, 81000, 91000, 101000, 111000, 121000, 131000, 141000, 151000, 161000, 171000, 181000, 191000, 201000, 211000, 221000, 231000, 241000, 251000, 261000, 271000, 281000, 291000, 301000, 311000, 321000, 331000, 341000, 351000, 361000, 371000, 381000, 391000, 401000]
    data[2003]["starting case"] = 305

    data[2004] = dict()
    data[2004]["video"] = "./clips/2004HINTS.mp4"
    data[2004]["times"] = [0, 10000, 19500, 32500, 43000, 54000, 60000, 71500, 80000, 90000, 98000, 108000, 118000, 128000, 138000, 148000, 158000, 168000, 177000, 187000, 196000, 207000, 217000, 227000, 237000, 247000, 255000, 265000, 274000, 287000, 297000, 305000, 316000, 326000, 335000, 345000, 356000, 364000, 374000]
    data[2004]["starting case"] = 346

    return data

def getpics(data, year):
    cap = cv2.VideoCapture(data[year]["video"])
    # case min 1 because the hint is for last episode
    hintnum = data[year]["starting case"] - 1 
    for time in data[year]["times"]:
        cap.set(cv2.CAP_PROP_POS_MSEC, time)
        success, image = cap.read()
        print hintnum 
        if success:
            cv2.imwrite("pics/" + str(year) + "/nch "+str(hintnum)+".png", image)
            cv2.imshow("20sec", image)
            cv2.waitKey()
        else:
            print "broke on " + str(hintnum)
            break

        hintnum += 1

def main():
    print arguments
    if arguments["<YEAR>"]:
        getpics(compile_data(), int(arguments["<YEAR>"]))
    else:
        print arguments

if __name__ == "__main__":
    main()
